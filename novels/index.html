<section class=novels-page style="max-width:980px;margin:24px auto;padding:0 16px"><h1 style="margin:0 0 12px">小说列表</h1><div id=novel-list aria-live=polite><div style=color:#888>正在连接 CloudBase…</div></div></section><script>(function(){const e=document.getElementById("novel-list"),n=window.cloudbaseCollections&&window.cloudbaseCollections.novels||"novels";function s(t){e.innerHTML=`<div style="color:#888">${t}</div>`}function t(t){e.innerHTML=`<div style="color:#d14343">${t}</div>`}async function o(e=5e3,t=200){const n=Date.now();for(;Date.now()-n<e;){if(window.cloudbaseDb&&window.cloudbaseAuth)return!0;await new Promise(e=>setTimeout(e,t))}return!1}async function i(){try{const t=location.hostname==="127.0.0.1"||location.hostname==="localhost";if(t)return;const e=window.cloudbaseAuth;if(!e)return;if(typeof e.getLoginState=="function"){const t=await e.getLoginState();if(t&&t.user)return}if(e.anonymousAuthProvider)try{await e.anonymousAuthProvider().signIn()}catch{}else if(e.signInAnonymously)try{await e.signInAnonymously()}catch{}}catch{}}async function a(){const a=await o(6e3,250);if(!a){t("CloudBase 未初始化（请检查 SDK 加载与环境配置）");return}await i();try{const i=window.cloudbaseDb,t=await i.collection(n).get(),o=t&&t.data||[];if(!o.length){s("暂无小说数据");return}const a=o.map(e=>{const s=e.title||"(未命名)",t=e.summary||"",n=Array.isArray(e.tags)?e.tags:[],o=n.length?`<div style="margin-top:6px;color:#6b7280;font-size:12px;">${n.map(e=>`#${e}`).join(" ")}</div>`:"";return`<div class="novel-item" style="margin:12px 0;padding:12px;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 3px 8px rgba(0,0,0,.05)">
          <div style="font-weight:700">${s}</div>
          ${t?`<div style="color:#4b5563">${t}</div>`:""}
          ${o}
        </div>`}).join("");e.innerHTML=a}catch(e){console.error("加载小说列表失败",e),t("加载失败，请稍后重试")}}a()})()</script>